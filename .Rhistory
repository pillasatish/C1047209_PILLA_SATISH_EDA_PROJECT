plot(2:11, bss_fit_AIC$Subsets$AIC, xlab="Number of predictors", ylab="AIC", type="b")
points(best_AIC, bss_fit_AIC$Subsets$AIC[best_AIC+1], col="red", pch=16)
plot(2:11, bss_fit_BIC$Subsets$BIC, xlab="Number of predictors", ylab="BIC", type="b")
points(best_BIC, bss_fit_BIC$Subsets$BIC[best_BIC+1], col="red", pch=16)
plot(2:11, bss_fit_CV$Subsets$CV, xlab="Number of predictors", ylab="CV", type="b")
points(best_CV, bss_fit_CV$Subsets$CV[best_CV+1], col="red", pch=16)
pstar=5
bss_fit_BIC$Subsets[pstar+1,]
X1=BreastCancer3[1:9]
#head(X1)
y=BreastCancer3$Class
(indices = as.logical(bss_fit_BIC$Subsets[pstar+1, 2:(9+1)]))
## [1] FALSE TRUE FALSE FALSE FALSE FALSE
BreastCancer4= data.frame(X1[,indices],y)
head(BreastCancer4)
X2=BreastCancer4[,1:5]
#head(X2)
y1=BreastCancer4[,6]
best_subset=function(X1,y,fold_ind)
{
Xy=data.frame(X1,y=y)
nfolds=max(fold_ind)
if(!all.equal(sort(unique(fold_ind)),1:nfolds))stop("Invalid fold partition.")
cv_errors=numeric(nfolds)
for(fold in 1:nfolds){
tmp_fit=glm(y~.,data=Xy[fold_ind!=fold,],family ="binomial")
phat_test_logistic = predict(tmp_fit, Xy[fold_ind==fold,], type = "response")
yhat_test_logistic = ifelse(phat_test_logistic > 0.5, 1, 0)
yhat=predict(tmp_fit, Xy[fold_ind==fold,])
yobs=y[fold_ind==fold]
#cv_errors[fold]=mean((yobs-yhat)^2)
cv_errors[fold] = 1 - mean((yobs == yhat_test_logistic))
}
fold_sizes=numeric(nfolds)
for(fold in 1:nfolds)
fold_sizes[fold]=length(which(fold_ind==fold))
test_error=weighted.mean(cv_errors,w=fold_sizes)
return(test_error)
}
test_error_sb=best_subset(X2,y1,fold_index)
test_error_sb
tinytex::install_tinytex()
install.packages("ProjectTemplate")
.libPaths()
myPaths <- .libPaths()
myPaths <- c(myPaths, ‘E:/Rpackages’)
myPaths <- .libPaths()
myPaths <- c(myPaths, "E:/Rpackages")
.libPaths(myPaths)
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("ProjectTemplate")
library("ProjectTemplate")
#create.project("21047209_PILLA_SATISH_EDA_PROJECT")
load.project()
students_enorlled=length(unique(cyber.security.5_enrolments$learner_id))
students_enorlled
summary(cyber.security.5_enrolments)
enrolled_students=as.data.frame(table(cyber.security.5_enrolments$detected_country))
#removing the row without country code.
enrolled_students=enrolled_students[-c(1),]
#selecting the countries with more than 50 enrollments
countries_with_more_than_50_enrollment=enrolled_students[enrolled_students$Freq>50,]
countries_with_more_than_50_enrollment %>%
ggplot(aes(reorder(Var1,-Freq),Freq))+
geom_bar(stat="identity", fill="#f68060",alpha=.8,width = .6)+
labs(title="No of students enrolled vs countries",x="countires",
y="No. of students enrolled from different countries")+
theme(plot.title = element_text(hjust = 0.5))
#
students_unenrolled=length(cyber.security.5_leaving.survey.responses$left_at)
students_unenrolled
Percentage_unenrolled=(students_unenrolled/students_enorlled)*100
Percentage_unenrolled
merge_enrollment_leaving_survey=
merge.data.frame(cyber.security.5_leaving.survey.responses,cyber.security.5_enrolments,on="learner_id")
unenrolled_students=as.data.frame(table(merge_enrollment_leaving_survey$detected_country))
countries_with_more_than_5_unenrollment=unenrolled_students[unenrolled_students$Freq>5,]
countries_with_more_than_5_unenrollment %>%
ggplot(aes(reorder(Var1,-Freq),Freq))+
geom_bar(stat="identity", fill="#f68060",alpha=.8,width = .6)+
labs(title="No of students unenrolled vs countries",x="countires",
y="No. of students unenrolled from different countries")+
theme(plot.title = element_text(hjust = 0.5))
students_unerolled_plot=as.data.frame(table(cyber.security.5_leaving.survey.responses$leaving_reason))
ggplot(students_unerolled_plot,aes(reorder(Var1,Freq),Freq))+
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.5) +
coord_flip() +
labs(title="No of students unenrolled vs reasons",x="Reasons",y="No .of stusents unenrolled")+
theme(plot.title = element_text(hjust = 0.5))
g=ggplot(cyber.security.5_video.stats)
g+geom_line(aes(x=step_position,y=europe_views_percentage,colour='EUROPE_VIEWS_PERCENTAGE'))+
geom_line(aes(x=step_position,y=oceania_views_percentage,colour='OCEANIA_VIEWS_PERCENTAGE'))+
geom_line(aes(x=step_position,y=asia_views_percentage,colour='ASIA_VIEWS_PERCENTAGE'))+
geom_line(aes(x=step_position,y=north_america_views_percentage,colour='NORTH_AMERICA_VIEWS_PERCENTAGE'))+
geom_line(aes(x=step_position,y=south_america_views_percentage,colour='SOUTH_AMERICA_VIEWS_PERCENTAGE'))+
geom_line(aes(x=step_position,y=africa_views_percentage,colour='AFRICA_VIEWS_PERCENTAGE'))+
scale_color_discrete("Pattern")+xlab("step position")+ylab("viewed percentage")
length(unique(cyber.security.5_step.activity$learner_id))
#Converting step into chapters to find out students visiting each chapter
#(student visited chapters atleast one time)
#Adding new column to cyber.security.5_step.activity dataset
Convert_step_to_chapter=cyber.security.5_step.activity %>%
mutate(learner_id,chapter=trunc(step))
student_views=as.data.frame(table(Convert_step_to_chapter$chapter))
ggplot(student_views,aes(reorder(Var1,-Freq),Freq))+
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
labs(title="Chapters vs total views",x="chapter",y="total views")+
theme(plot.title = element_text(hjust = 0.5))
#the function return the number of students visiting each chapter.
student_visiting=function(x){ #x is dataframe(step.activity dataset modified to convert_step_to_chapter dataframe)
a=c()
for(i in 1:3){
y=x %>%
filter(x$chapter==i)
z=distinct(y,learner_id,.keep_all = TRUE)
b=nrow(z)
a=c(a,b)
}
return(a)
}
No_student_visited_chapter=student_visiting(Convert_step_to_chapter)
plot_student_vistied=data.frame(chapter=c("1","2","3"),
No_of_students_visited=No_student_visited_chapter)
ggplot(plot_student_vistied,aes(x=chapter,y=No_of_students_visited))+
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
labs(title="chapter vs students view",x="chapter",y="No.of students visited each chapter")+
theme(plot.title = element_text(hjust = 0.5))
plot_student_vistied %>%
mutate(chapter,percentage=(No_of_students_visited/2708)*100)
df30=as.data.frame(table(cyber.security.5_question.response$quiz_question))
ggplot(df30,aes(Var1,Freq))+geom_point(aes(color=-Freq, size=Freq),show.legend = F) +
coord_flip() + scale_fill_gradient(name="Total no of students attempted")+
labs(title="quiz question vs number of students attempting the quiz",x="quiz questions",
y="No. of students attempt")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(cyber.security.5_video.stats,aes(reorder(step_position,-total_views),total_views))+
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4)+
labs(title="step position vs total views",x="step position",y="total views")+
theme(plot.title = element_text(hjust = 0.5))
load.project()
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("ProjectTemplate")
library("ProjectTemplate")
#create.project("21047209_PILLA_SATISH_EDA_PROJECT")
load.project()
students_enorlled=length(unique(cyber.security.5_enrolments$learner_id))
students_enorlled
enrolled_students=as.data.frame(table(cyber.security.5_enrolments$detected_country))
#removing the row without country code.
enrolled_students=enrolled_students[-c(1),]
#selecting the countries with more than 50 enrollments
countries_with_more_than_50_enrollment=enrolled_students[enrolled_students$Freq>50,]
countries_with_more_than_50_enrollment %>%
ggplot(aes(reorder(Var1,-Freq),Freq))+
geom_bar(stat="identity", fill="#f68060",alpha=.8,width = .6)+
labs(title="No of students enrolled vs Countries",x="Countires",
y="No. of students enrolled from different countries")+
theme(plot.title = element_text(hjust = 0.5))
#
students_unenrolled=length(cyber.security.5_leaving.survey.responses$left_at)
students_unenrolled
Percentage_unenrolled=(students_unenrolled/students_enorlled)*100
Percentage_unenrolled
merge_enrollment_leaving_survey=
merge.data.frame(cyber.security.5_leaving.survey.responses,cyber.security.5_enrolments,on="learner_id")
unenrolled_students=as.data.frame(table(merge_enrollment_leaving_survey$detected_country))
countries_with_more_than_5_unenrollment=unenrolled_students[unenrolled_students$Freq>5,]
countries_with_more_than_5_unenrollment %>%
ggplot(aes(reorder(Var1,-Freq),Freq))+
geom_bar(stat="identity", fill="#f68060",alpha=.8,width = .6)+
labs(title="No of students unenrolled vs Countries",x="Countires",
y="No. of students unenrolled from different countries")+
theme(plot.title = element_text(hjust = 0.5))
students_unerolled_plot=as.data.frame(table(cyber.security.5_leaving.survey.responses$leaving_reason))
ggplot(students_unerolled_plot,aes(reorder(Var1,Freq),Freq))+
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.5) +
coord_flip() +
labs(title="No of students unenrolled vs reasons",x="Reasons",y="No .of students unenrolled")+
theme(plot.title = element_text(hjust = 0.5))
g=ggplot(cyber.security.5_video.stats)
g+geom_line(aes(x=step_position,y=europe_views_percentage,colour='Europe view percentage'))+
geom_line(aes(x=step_position,y=oceania_views_percentage,colour='Oceania view percentage'))+
geom_line(aes(x=step_position,y=asia_views_percentage,colour='Asia view percentage'))+
geom_line(aes(x=step_position,y=north_america_views_percentage,colour='North America view percentage'))+
geom_line(aes(x=step_position,y=south_america_views_percentage,colour='South America view percentage '))+
geom_line(aes(x=step_position,y=africa_views_percentage,colour='Africa view percentage'))+
scale_color_discrete("Pattern")+xlab("step position")+ylab("viewed percentage")
enrollment.list=list(cyber.security.1_enrolments,cyber.security.2_enrolments,cyber.security.3_enrolments,cyber.security.4_enrolments,cyber.security.5_enrolments,cyber.security.6_enrolments,cyber.security.7_enrolments)
students_enrollements_over_7_runs=lapply(enrollment.list, function(x) length(unique(x$learner_id)))
students=data.frame(students_enrollements_over_7_runs)
colnames(students)=c("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
students
students <- melt(students)
matplot(t(students), type = "l")
ggplot(t(students))
students_enrollements_over_7_runs
std=function(x){
y=c()
z=length(unique(x$learner_id))
y=c(y,z)
return(y)
}
std(enrollment.list)
std=function(x){
y=c()
z=length(unique(x$learner_id))
y=c(y,z)
return(y)
}
std(cyber.security.1_enrolments)
students=data.frame(students_enrollements_over_7_runs)
students
students_enrollements_over_7_runs
students1array(as.numeric(unlist(students_enrollements_over_7_runs)), dim=c(7, 1, 1))
students1=array(as.numeric(unlist(students_enrollements_over_7_runs)), dim=c(7, 1, 1))
students1
students=data.frame(students1)
students
colnames(students)=c("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
students
ggplot(students)
students
rownames(students)=c("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
students
ggplot(students)
View(students)
rownames(students)=c(runs=("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time"))
rownames(students)=c("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
students
students1
ggplot(students1)
students=data.frame(students1)
students
ggplot(students)
View(students)
colnames(students)=c("runs","students")
colnames(students)=c("runs")
students
rownames(students)=c("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
colnames(students)=c("runs")
colnames(students)=c("runs","a")
students
students
students=data.frame(students1)
students
row_names=data.frame("1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
row_names=data.frame(runs="1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
row_names
row_names=t(row_names)
row_names
merge(row_names,students)
list_of_students=merge(row_names,students)
ggplot(students)
plot(students)
students_enrollements_over_7_runs
list_of_students=merge(row_names,students)
list_of_students
students_enrollements_over_7_runs
row_names=data.frame(runs="1st time","2nd time ","3rd time","4th time","5th time","6th time","7th time")
list_of_students=merge(row_names,students_enrollements_over_7_runs)
list_of_students
list_of_students=rbind(row_names,students_enrollements_over_7_runs)
list_of_students
plot(list_of_students)
list_of_students
list_of_students=t(list_of_students)
list_of_students
list_of_students=rbind(row_names,students_enrollements_over_7_runs)
list_of_students
list_of_students=t(list_of_students)
list_of_students
list_of_students=rbind(students_enrollements_over_7_runs,row_names)
list_of_students
list_of_students=t(list_of_students)
list_of_students
plot(list_of_students)
list_of_students=t(as.numeric(list_of_students))
list_of_students
list_of_students
plot(list_of_students)
list_of_students=rbind(students_enrollements_over_7_runs,row_names)
list_of_students
students_enrollements_over_7_runs
students1=array(as.numeric(unlist(students_enrollements_over_7_runs)), dim=c(7, 1, 1))
students1
students=data.frame(students1)
students
c=tibble::rownames_to_column(students,"runs")
c
plot(c)
students1
students=data.frame(students1)
students
c=tibble::rownames_to_column(students,"runs")
c
plot(c)
View(c)
ggplot(c,aes(reorder(runs,students1),students1))+
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.5) +
coord_flip() +
labs(title="No of students unenrolled vs reasons",x="Reasons",y="No .of students unenrolled")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(c,aes(reorder(runs,students1),students1))+
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.5) +
labs(title="No of students unenrolled vs reasons",x="Reasons",y="No .of students unenrolled")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(c,aes(runs,students1),students1)+
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.5) +
labs(title="No of students unenrolled vs reasons",x="Reasons",y="No .of students unenrolled")+
theme(plot.title = element_text(hjust = 0.5))
View(c)
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("ProjectTemplate")
library("ProjectTemplate")
#create.project("B21047209_PILLA_SATISH_EDA_PROJECT")
load.project()
install.packages("latexpdf")
library(latexpdf)
update.packages(ask = FALSE, checkBuilt = TRUE)
tinytex::tlmgr_update()
tinytex::reinstall_tinytex()
load.project()
setwd("C:/Users/pilla/Desktop/C1047209_PILLA_SATISH_EDA_PROJECT")
#Reading all the video_stat dataset files
cyber_security_3_video_stats <- read_csv("data/cyber-security-3_video-stats.csv")
cyber_security_4_video_stats <- read_csv("data/cyber-security-4_video-stats.csv")
cyber_security_5_video_stats <- read_csv("data/cyber-security-5_video-stats.csv")
cyber_security_6_video_stats <- read_csv("data/cyber-security-6_video-stats.csv")
cyber_security_7_video_stats <- read_csv("data/cyber-security-7_video-stats.csv")
library(readr)
#Reading all the video_stat dataset files
cyber_security_3_video_stats <- read_csv("data/cyber-security-3_video-stats.csv")
cyber_security_4_video_stats <- read_csv("data/cyber-security-4_video-stats.csv")
cyber_security_5_video_stats <- read_csv("data/cyber-security-5_video-stats.csv")
cyber_security_6_video_stats <- read_csv("data/cyber-security-6_video-stats.csv")
cyber_security_7_video_stats <- read_csv("data/cyber-security-7_video-stats.csv")
video_stat= rbind(cyber_security_3_video_stats, cyber_security_4_video_stats, cyber_security_5_video_stats, cyber_security_6_video_stats, cyber_security_7_video_stats)
per_cont = data.frame(video_stat$europe_views_percentage, video_stat$north_america_views_percentage,  video_stat$asia_views_percentage, video_stat$africa_views_percentage, video_stat$south_america_views_percentage, video_stat$oceania_views_percentage)
colnames(per_cont) =  c("Europe", "North-America", "Asia","Africa","South-America","Oceania")
avg_cont_view = per_cont %>% summarise_if(is.numeric, mean)
#avg_cont_view
conti_name = data.frame(cont=c("Europe", "North-America", "Asia","Africa","South-America","Oceania"),avg =as.numeric(avg_cont_view))
avg= conti_name$avg
library(dplyr)
library(dbplyr)
library(dtplyr)
per_cont = data.frame(video_stat$europe_views_percentage, video_stat$north_america_views_percentage,  video_stat$asia_views_percentage, video_stat$africa_views_percentage, video_stat$south_america_views_percentage, video_stat$oceania_views_percentage)
colnames(per_cont) =  c("Europe", "North-America", "Asia","Africa","South-America","Oceania")
avg_cont_view = per_cont %>% summarise_if(is.numeric, mean)
#avg_cont_view
conti_name = data.frame(cont=c("Europe", "North-America", "Asia","Africa","South-America","Oceania"),avg =as.numeric(avg_cont_view))
avg= conti_name$avg
round(avg, digits = 1)
cont = conti_name$cont #############
cont = cont[order(avg)]
avg = sort(avg)
round(avg,digits = 1)
cont.factor = factor(cont, levels = as.character(cont))#########
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
library(ggplot2)
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
cont.factor
avg
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
view_stat=data.frame(avg,cont.factor)
view_stat
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
ypos = cumsum(avg) - 0.5 * avg
ypos = 100 - ypos
p = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlOrRd", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)
p
p = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "Greens", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("VIDEO VIEWS BASED ON GEOGRAPHICAL REGIONS") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
ypos = cumsum(avg) - 0.5 * avg
ypos = 100 - ypos
p = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "Greens", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)
p
p = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "Blues", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)
p
p = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "GnBu", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)
p
#video views based on Geographical regions
vid_stat = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "GnBu", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)+
theme(plot.title = element_text(hjust = 0.5,face = 'bold'))
vid_stat
view_stat
#video views based on Geographical regions
p0 = ggplot() + theme_bw() +
geom_bar(aes(x = "", y = avg, fill = cont.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Video Views Based on Geographical Regions") +
theme(plot.title = element_text(hjust = 0.1, size = 15),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid=element_blank(),
panel.border = element_blank())
ypos = cumsum(avg) - 0.5 * avg
ypos = 100 - ypos
vid_stat = p0 +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "GnBu", name = "Regions") +
theme(legend.text=element_text(size=15),
legend.title = element_text(hjust = 0.5, size=15),
legend.key.size = unit(0.5,"cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(round(avg, digits = 1), "%")), size = 2.2)+
theme(plot.title = element_text(hjust = 0.5,face = 'bold'))
vid_stat
